button:
  - platform: restart
    name: "WaveShare P4 Box"

number:
  - platform: template
    name: "Set CPU Min Value"
    id: set_cpu_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 100
    initial_value: 0
    step: 1
    restore_value: true
  - platform: template
    name: "Set CPU Max Value"
    id: set_cpu_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 150
    initial_value: 80
    step: 1
    restore_value: true
  - platform: template
    name: "Set Fan Min Value"
    id: set_fan_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1000
    initial_value: 0
    step: 100
    restore_value: true
  - platform: template
    name: "Set Fan Max Value"
    id: set_fan_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 8000
    initial_value: 5500
    step: 100
    restore_value: true
  - platform: template
    name: "Set Env Min Value"
    id: set_env_min
    internal: true
    optimistic: true
    min_value: -40
    max_value: 50
    initial_value: -20
    step: 1
    restore_value: true
  - platform: template
    name: "Set Env Max Value"
    id: set_env_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 100
    initial_value: 70
    step: 1
    restore_value: true
  - platform: template
    name: "Set Power Min Value"
    id: set_pwr_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 0
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set Power Max Value"
    id: set_pwr_max
    internal: true
    optimistic: true
    min_value: 1
    max_value: 100
    initial_value: 17
    step: 1
    restore_value: true
  - platform: template
    name: "Set SQM Min Value"
    id: set_sqm_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 23
    initial_value: 1
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set SQM Max Value"
    id: set_sqm_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 24
    initial_value: 22
    step: 0.1
    restore_value: true

  # NINA2 Min/Max Values
  - platform: template
    name: "Set NINA2 RMS Min Value"
    id: set_nina2_rms_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 0.3
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA2 RMS Max Value"
    id: set_nina2_rms_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 1.3
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA2 HFR Min Value"
    id: set_nina2_hfr_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 1.5
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA2 HFR Max Value"
    id: set_nina2_hfr_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 4.0
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA2 EXP NUM Min Value"
    id: set_nina2_exp_num_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1000
    initial_value: 0
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA2 EXP NUM Max Value"
    id: set_nina2_exp_num_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1000
    initial_value: 60
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA2 EXP TIME Min Value"
    id: set_nina2_exp_time_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1200
    initial_value: 10
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA2 EXP TIME Max Value"
    id: set_nina2_exp_time_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1200
    initial_value: 1200
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA2 CAM TEMP Min Value"
    id: set_nina2_cam_temp_min
    internal: true
    optimistic: true
    min_value: -40
    max_value: 50
    initial_value: -10
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA2 CAM TEMP Max Value"
    id: set_nina2_cam_temp_max
    internal: true
    optimistic: true
    min_value: -40
    max_value: 50
    initial_value: 10
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA2 STARS Min Value"
    id: set_nina2_stars_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10000
    initial_value: 20
    step: 10
    restore_value: true
  - platform: template
    name: "Set NINA2 STARS Max Value"
    id: set_nina2_stars_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10000
    initial_value: 200
    step: 10
    restore_value: true
  - platform: template
    name: "Set NINA2 SAT PX Min Value"
    id: set_nina2_sat_px_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 100000
    initial_value: 0
    step: 100
    restore_value: true
  - platform: template
    name: "Set NINA2 SAT PX Max Value"
    id: set_nina2_sat_px_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 100000
    initial_value: 500
    step: 100
    restore_value: true

  # NINA3 Min/Max Values
  - platform: template
    name: "Set NINA3 RMS Min Value"
    id: set_nina3_rms_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 0.3
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA3 RMS Max Value"
    id: set_nina3_rms_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 3.5
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA3 HFR Min Value"
    id: set_nina3_hfr_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 1.0
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA3 HFR Max Value"
    id: set_nina3_hfr_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10
    initial_value: 4.5
    step: 0.1
    restore_value: true
  - platform: template
    name: "Set NINA3 EXP NUM Min Value"
    id: set_nina3_exp_num_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1000
    initial_value: 0
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA3 EXP NUM Max Value"
    id: set_nina3_exp_num_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1000
    initial_value: 100
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA3 EXP TIME Min Value"
    id: set_nina3_exp_time_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1200
    initial_value: 10
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA3 EXP TIME Max Value"
    id: set_nina3_exp_time_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 1200
    initial_value: 1200
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA3 CAM TEMP Min Value"
    id: set_nina3_cam_temp_min
    internal: true
    optimistic: true
    min_value: -40
    max_value: 50
    initial_value: -10
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA3 CAM TEMP Max Value"
    id: set_nina3_cam_temp_max
    internal: true
    optimistic: true
    min_value: -40
    max_value: 50
    initial_value: 10
    step: 1
    restore_value: true
  - platform: template
    name: "Set NINA3 STARS Min Value"
    id: set_nina3_stars_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10000
    initial_value: 100
    step: 10
    restore_value: true
  - platform: template
    name: "Set NINA3 STARS Max Value"
    id: set_nina3_stars_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 10000
    initial_value: 2000
    step: 10
    restore_value: true
  - platform: template
    name: "Set NINA3 SAT PX Min Value"
    id: set_nina3_sat_px_min
    internal: true
    optimistic: true
    min_value: 0
    max_value: 100000
    initial_value: 0
    step: 100
    restore_value: true
  - platform: template
    name: "Set NINA3 SAT PX Max Value"
    id: set_nina3_sat_px_max
    internal: true
    optimistic: true
    min_value: 0
    max_value: 100000
    initial_value: 500
    step: 100
    restore_value: true

switch:
  - platform: template
    name: "Match Text Color"
    id: match_text_color
    internal: true
    optimistic: true
    restore_mode: RESTORE_DEFAULT_ON
    on_turn_on:
      - lambda: |-
          if (!isnan(id(ha_cpu_temp).state)) {
             float x = id(ha_cpu_temp).state;
             float min = id(set_cpu_min).state;
             float max = id(set_cpu_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_cpu_c1_r) + ratio * (id(g_cpu_c2_r) - id(g_cpu_c1_r)));
             int g = (int)(id(g_cpu_c1_g) + ratio * (id(g_cpu_c2_g) - id(g_cpu_c1_g)));
             int b = (int)(id(g_cpu_c1_b) + ratio * (id(g_cpu_c2_b) - id(g_cpu_c1_b)));
             lv_obj_set_style_text_color(id(lbl_cpu_temp_val), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(ha_sqm).state)) {
             float x = id(ha_sqm).state;
             float min = id(set_sqm_min).state;
             float max = id(set_sqm_max).state;
             if (max <= min) max = min + 0.1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_sqm_c1_r) + ratio * (id(g_sqm_c2_r) - id(g_sqm_c1_r)));
             int g = (int)(id(g_sqm_c1_g) + ratio * (id(g_sqm_c2_g) - id(g_sqm_c1_g)));
             int b = (int)(id(g_sqm_c1_b) + ratio * (id(g_sqm_c2_b) - id(g_sqm_c1_b)));
             lv_obj_set_style_text_color(id(lbl_sqm_val), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(ha_enclosure_temp).state)) {
             float x = id(ha_enclosure_temp).state;
             float min = id(set_env_min).state;
             float max = id(set_env_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_env_c1_r) + ratio * (id(g_env_c2_r) - id(g_env_c1_r)));
             int g = (int)(id(g_env_c1_g) + ratio * (id(g_env_c2_g) - id(g_env_c1_g)));
             int b = (int)(id(g_env_c1_b) + ratio * (id(g_env_c2_b) - id(g_env_c1_b)));
             lv_obj_set_style_text_color(id(lbl_enclosure_temp_val), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(ha_power).state)) {
             float x = id(ha_power).state;
             float min = id(set_pwr_min).state;
             float max = id(set_pwr_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_pwr_c1_r) + ratio * (id(g_pwr_c2_r) - id(g_pwr_c1_r)));
             int g = (int)(id(g_pwr_c1_g) + ratio * (id(g_pwr_c2_g) - id(g_pwr_c1_g)));
             int b = (int)(id(g_pwr_c1_b) + ratio * (id(g_pwr_c2_b) - id(g_pwr_c1_b)));
             lv_obj_set_style_text_color(id(lbl_power_val), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          // NINA2 Color Updates
          if (!isnan(id(nina2_total_rms).state)) {
             float x = id(nina2_total_rms).state;
             float min = id(set_nina2_rms_min).state;
             float max = id(set_nina2_rms_max).state;
             if (max <= min) max = min + 0.1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_rms_c1_r) + ratio * (id(g_nina2_rms_c2_r) - id(g_nina2_rms_c1_r)));
             int g = (int)(id(g_nina2_rms_c1_g) + ratio * (id(g_nina2_rms_c2_g) - id(g_nina2_rms_c1_g)));
             int b = (int)(id(g_nina2_rms_c1_b) + ratio * (id(g_nina2_rms_c2_b) - id(g_nina2_rms_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_rms), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
             lv_obj_set_style_text_color(id(lbl_cmb_nina2_rms), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina2_hfr).state)) {
             float x = id(nina2_hfr).state;
             float min = id(set_nina2_hfr_min).state;
             float max = id(set_nina2_hfr_max).state;
             if (max <= min) max = min + 0.1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_hfr_c1_r) + ratio * (id(g_nina2_hfr_c2_r) - id(g_nina2_hfr_c1_r)));
             int g = (int)(id(g_nina2_hfr_c1_g) + ratio * (id(g_nina2_hfr_c2_g) - id(g_nina2_hfr_c1_g)));
             int b = (int)(id(g_nina2_hfr_c1_b) + ratio * (id(g_nina2_hfr_c2_b) - id(g_nina2_hfr_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_hfr), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina2_exposure_num).state)) {
             float x = id(nina2_exposure_num).state;
             float min = id(set_nina2_exp_num_min).state;
             float max = id(set_nina2_exp_num_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_exp_num_c1_r) + ratio * (id(g_nina2_exp_num_c2_r) - id(g_nina2_exp_num_c1_r)));
             int g = (int)(id(g_nina2_exp_num_c1_g) + ratio * (id(g_nina2_exp_num_c2_g) - id(g_nina2_exp_num_c1_g)));
             int b = (int)(id(g_nina2_exp_num_c1_b) + ratio * (id(g_nina2_exp_num_c2_b) - id(g_nina2_exp_num_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_exp_num), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
             lv_obj_set_style_text_color(id(lbl_cmb_nina2_exp_num), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina2_exposure_time).state)) {
             float x = id(nina2_exposure_time).state;
             float min = id(set_nina2_exp_time_min).state;
             float max = id(set_nina2_exp_time_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_exp_time_c1_r) + ratio * (id(g_nina2_exp_time_c2_r) - id(g_nina2_exp_time_c1_r)));
             int g = (int)(id(g_nina2_exp_time_c1_g) + ratio * (id(g_nina2_exp_time_c2_g) - id(g_nina2_exp_time_c1_g)));
             int b = (int)(id(g_nina2_exp_time_c1_b) + ratio * (id(g_nina2_exp_time_c2_b) - id(g_nina2_exp_time_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_exp_time), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
             lv_obj_set_style_text_color(id(lbl_cmb_nina2_exp_time), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina2_camera_temp).state)) {
             float x = id(nina2_camera_temp).state;
             float min = id(set_nina2_cam_temp_min).state;
             float max = id(set_nina2_cam_temp_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_cam_temp_c1_r) + ratio * (id(g_nina2_cam_temp_c2_r) - id(g_nina2_cam_temp_c1_r)));
             int g = (int)(id(g_nina2_cam_temp_c1_g) + ratio * (id(g_nina2_cam_temp_c2_g) - id(g_nina2_cam_temp_c1_g)));
             int b = (int)(id(g_nina2_cam_temp_c1_b) + ratio * (id(g_nina2_cam_temp_c2_b) - id(g_nina2_cam_temp_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_cam_temp), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina2_detected_stars).state)) {
             float x = id(nina2_detected_stars).state;
             float min = id(set_nina2_stars_min).state;
             float max = id(set_nina2_stars_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_stars_c1_r) + ratio * (id(g_nina2_stars_c2_r) - id(g_nina2_stars_c1_r)));
             int g = (int)(id(g_nina2_stars_c1_g) + ratio * (id(g_nina2_stars_c2_g) - id(g_nina2_stars_c1_g)));
             int b = (int)(id(g_nina2_stars_c1_b) + ratio * (id(g_nina2_stars_c2_b) - id(g_nina2_stars_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_stars), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina2_saturated_pixels).state)) {
             float x = id(nina2_saturated_pixels).state;
             float min = id(set_nina2_sat_px_min).state;
             float max = id(set_nina2_sat_px_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina2_sat_px_c1_r) + ratio * (id(g_nina2_sat_px_c2_r) - id(g_nina2_sat_px_c1_r)));
             int g = (int)(id(g_nina2_sat_px_c1_g) + ratio * (id(g_nina2_sat_px_c2_g) - id(g_nina2_sat_px_c1_g)));
             int b = (int)(id(g_nina2_sat_px_c1_b) + ratio * (id(g_nina2_sat_px_c2_b) - id(g_nina2_sat_px_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina2_sat_px), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          // NINA3 Color Updates
          if (!isnan(id(nina3_total_rms).state)) {
             float x = id(nina3_total_rms).state;
             float min = id(set_nina3_rms_min).state;
             float max = id(set_nina3_rms_max).state;
             if (max <= min) max = min + 0.1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_rms_c1_r) + ratio * (id(g_nina3_rms_c2_r) - id(g_nina3_rms_c1_r)));
             int g = (int)(id(g_nina3_rms_c1_g) + ratio * (id(g_nina3_rms_c2_g) - id(g_nina3_rms_c1_g)));
             int b = (int)(id(g_nina3_rms_c1_b) + ratio * (id(g_nina3_rms_c2_b) - id(g_nina3_rms_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_rms), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
             lv_obj_set_style_text_color(id(lbl_cmb_nina3_rms), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina3_hfr).state)) {
             float x = id(nina3_hfr).state;
             float min = id(set_nina3_hfr_min).state;
             float max = id(set_nina3_hfr_max).state;
             if (max <= min) max = min + 0.1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_hfr_c1_r) + ratio * (id(g_nina3_hfr_c2_r) - id(g_nina3_hfr_c1_r)));
             int g = (int)(id(g_nina3_hfr_c1_g) + ratio * (id(g_nina3_hfr_c2_g) - id(g_nina3_hfr_c1_g)));
             int b = (int)(id(g_nina3_hfr_c1_b) + ratio * (id(g_nina3_hfr_c2_b) - id(g_nina3_hfr_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_hfr), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina3_exposure_num).state)) {
             float x = id(nina3_exposure_num).state;
             float min = id(set_nina3_exp_num_min).state;
             float max = id(set_nina3_exp_num_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_exp_num_c1_r) + ratio * (id(g_nina3_exp_num_c2_r) - id(g_nina3_exp_num_c1_r)));
             int g = (int)(id(g_nina3_exp_num_c1_g) + ratio * (id(g_nina3_exp_num_c2_g) - id(g_nina3_exp_num_c1_g)));
             int b = (int)(id(g_nina3_exp_num_c1_b) + ratio * (id(g_nina3_exp_num_c2_b) - id(g_nina3_exp_num_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_exp_num), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
             lv_obj_set_style_text_color(id(lbl_cmb_nina3_exp_num), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina3_exposure_time).state)) {
             float x = id(nina3_exposure_time).state;
             float min = id(set_nina3_exp_time_min).state;
             float max = id(set_nina3_exp_time_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_exp_time_c1_r) + ratio * (id(g_nina3_exp_time_c2_r) - id(g_nina3_exp_time_c1_r)));
             int g = (int)(id(g_nina3_exp_time_c1_g) + ratio * (id(g_nina3_exp_time_c2_g) - id(g_nina3_exp_time_c1_g)));
             int b = (int)(id(g_nina3_exp_time_c1_b) + ratio * (id(g_nina3_exp_time_c2_b) - id(g_nina3_exp_time_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_exp_time), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
             lv_obj_set_style_text_color(id(lbl_cmb_nina3_exp_time), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina3_camera_temp).state)) {
             float x = id(nina3_camera_temp).state;
             float min = id(set_nina3_cam_temp_min).state;
             float max = id(set_nina3_cam_temp_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_cam_temp_c1_r) + ratio * (id(g_nina3_cam_temp_c2_r) - id(g_nina3_cam_temp_c1_r)));
             int g = (int)(id(g_nina3_cam_temp_c1_g) + ratio * (id(g_nina3_cam_temp_c2_g) - id(g_nina3_cam_temp_c1_g)));
             int b = (int)(id(g_nina3_cam_temp_c1_b) + ratio * (id(g_nina3_cam_temp_c2_b) - id(g_nina3_cam_temp_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_cam_temp), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina3_detected_stars).state)) {
             float x = id(nina3_detected_stars).state;
             float min = id(set_nina3_stars_min).state;
             float max = id(set_nina3_stars_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_stars_c1_r) + ratio * (id(g_nina3_stars_c2_r) - id(g_nina3_stars_c1_r)));
             int g = (int)(id(g_nina3_stars_c1_g) + ratio * (id(g_nina3_stars_c2_g) - id(g_nina3_stars_c1_g)));
             int b = (int)(id(g_nina3_stars_c1_b) + ratio * (id(g_nina3_stars_c2_b) - id(g_nina3_stars_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_stars), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
          if (!isnan(id(nina3_saturated_pixels).state)) {
             float x = id(nina3_saturated_pixels).state;
             float min = id(set_nina3_sat_px_min).state;
             float max = id(set_nina3_sat_px_max).state;
             if (max <= min) max = min + 1;
             float ratio = (x - min) / (max - min);
             if (ratio < 0.0) ratio = 0.0; else if (ratio > 1.0) ratio = 1.0;
             int r = (int)(id(g_nina3_sat_px_c1_r) + ratio * (id(g_nina3_sat_px_c2_r) - id(g_nina3_sat_px_c1_r)));
             int g = (int)(id(g_nina3_sat_px_c1_g) + ratio * (id(g_nina3_sat_px_c2_g) - id(g_nina3_sat_px_c1_g)));
             int b = (int)(id(g_nina3_sat_px_c1_b) + ratio * (id(g_nina3_sat_px_c2_b) - id(g_nina3_sat_px_c1_b)));
             lv_obj_set_style_text_color(id(lbl_nina3_sat_px), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
          }
    on_turn_off:
      - lambda: |-
          lv_color_t white = lv_color_hex(0xFFFFFF);
          lv_obj_set_style_text_color(id(lbl_cpu_temp_val), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_sqm_val), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_enclosure_temp_val), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_power_val), white, LV_PART_MAIN);
          // NINA2 reset to white
          lv_obj_set_style_text_color(id(lbl_nina2_rms), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina2_hfr), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina2_exp_num), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina2_exp_time), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina2_cam_temp), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina2_stars), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina2_sat_px), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_cmb_nina2_rms), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_cmb_nina2_exp_num), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_cmb_nina2_exp_time), white, LV_PART_MAIN);
          // NINA3 reset to white
          lv_obj_set_style_text_color(id(lbl_nina3_rms), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina3_hfr), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina3_exp_num), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina3_exp_time), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina3_cam_temp), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina3_stars), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_nina3_sat_px), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_cmb_nina3_rms), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_cmb_nina3_exp_num), white, LV_PART_MAIN);
          lv_obj_set_style_text_color(id(lbl_cmb_nina3_exp_time), white, LV_PART_MAIN);

  - platform: template
    name: "Enable Plant Page"
    id: switch_enable_plants
    optimistic: true
    restore_mode: RESTORE_DEFAULT_ON
    turn_on_action:
      - globals.set:
          id: g_plants_enabled
          value: 'true'
    turn_off_action:
      - globals.set:
          id: g_plants_enabled
          value: 'false'

select:
  - platform: template
    name: "Theme Selection"
    id: theme_selector
    optimistic: true
    initial_option: "Royal Purple"
    restore_value: true
    options:
      - "Modern Slate"
      - "Midnight Black"
      - "Deep Ocean"
      - "Forest Night"
      - "Cyber Neon"
      - "Crimson Dark"
      - "Solar Flare"
      - "Royal Purple"
    set_action:
      - lambda: |-
          lv_color_t bg_c, card_c, border_c;
          std::string val = x;
          
          // Default / Modern Slate
          bg_c = lv_color_hex(0x050505);
          card_c = lv_color_hex(0x111111);
          border_c = lv_color_hex(0x333333);

          if (val == "Midnight Black") { 
             bg_c = lv_color_hex(0x000000); 
             card_c = lv_color_hex(0x000000); 
             border_c = lv_color_hex(0x222222);
          }
          else if (val == "Deep Ocean") { 
             bg_c = lv_color_hex(0x010205); 
             card_c = lv_color_hex(0x080c14); 
             border_c = lv_color_hex(0x1a2e4d); 
          }
          else if (val == "Forest Night") { 
             bg_c = lv_color_hex(0x010301); 
             card_c = lv_color_hex(0x051005); 
             border_c = lv_color_hex(0x103010); 
          }
          else if (val == "Cyber Neon") { 
             bg_c = lv_color_hex(0x030003); 
             card_c = lv_color_hex(0x120412); 
             border_c = lv_color_hex(0x360e36); 
          }
          else if (val == "Crimson Dark") { 
             bg_c = lv_color_hex(0x050101); 
             card_c = lv_color_hex(0x140505); 
             border_c = lv_color_hex(0x381010); 
          }
          else if (val == "Solar Flare") { 
             bg_c = lv_color_hex(0x050201); 
             card_c = lv_color_hex(0x140a05); 
             border_c = lv_color_hex(0x381e0e); 
          }
          else if (val == "Royal Purple") { 
             bg_c = lv_color_hex(0x030105); 
             card_c = lv_color_hex(0x0a0514); 
             border_c = lv_color_hex(0x241240); 
          }

          if (id(main_container) != nullptr) {
              lv_obj_set_style_bg_color(id(main_container), bg_c, LV_PART_MAIN);
          }
          if (id(combined_nina_container) != nullptr) {
              lv_obj_set_style_bg_color(id(combined_nina_container), bg_c, LV_PART_MAIN);
          }
          if (id(nina2_container) != nullptr) {
              lv_obj_set_style_bg_color(id(nina2_container), bg_c, LV_PART_MAIN);
          }
          if (id(nina3_container) != nullptr) {
              lv_obj_set_style_bg_color(id(nina3_container), bg_c, LV_PART_MAIN);
          }
          if (id(plants_container) != nullptr) {
              lv_obj_set_style_bg_color(id(plants_container), bg_c, LV_PART_MAIN);
          }

          auto apply_theme = [](lv_obj_t *obj, lv_color_t bg, lv_color_t border) {
              if (obj != nullptr) {
                  lv_obj_set_style_bg_color(obj, bg, LV_PART_MAIN);
                  lv_obj_set_style_bg_opa(obj, LV_OPA_COVER, LV_PART_MAIN);
                  lv_obj_set_style_border_color(obj, border, LV_PART_MAIN);
              }
          };
          
          // Main page cards
          apply_theme(id(card_thermal), card_c, border_c);
          apply_theme(id(card_system), card_c, border_c);
          apply_theme(id(card_ambient), card_c, border_c);
          apply_theme(id(card_power), card_c, border_c);
          
          // Combined NINA page cards
          apply_theme(id(card_cmb_nina2), card_c, border_c);
          apply_theme(id(card_cmb_nina3), card_c, border_c);
          
          // NINA2 page cells
          apply_theme(id(nina2_cell_target), card_c, border_c);
          apply_theme(id(nina2_cell_rms), card_c, border_c);
          apply_theme(id(nina2_cell_hfr), card_c, border_c);
          apply_theme(id(nina2_cell_power), card_c, border_c);
          apply_theme(id(nina2_cell_exp_num), card_c, border_c);
          apply_theme(id(nina2_cell_exp_time), card_c, border_c);
          apply_theme(id(nina2_cell_sat_px), card_c, border_c);
          apply_theme(id(nina2_cell_filter), card_c, border_c);
          apply_theme(id(nina2_cell_cam_temp), card_c, border_c);
          apply_theme(id(nina2_cell_stars), card_c, border_c);
          apply_theme(id(nina2_cell_cloud_detector), card_c, border_c);
          
          // NINA3 page cells
          apply_theme(id(nina3_cell_target), card_c, border_c);
          apply_theme(id(nina3_cell_rms), card_c, border_c);
          apply_theme(id(nina3_cell_hfr), card_c, border_c);
          apply_theme(id(nina3_cell_power), card_c, border_c);
          apply_theme(id(nina3_cell_exp_num), card_c, border_c);
          apply_theme(id(nina3_cell_exp_time), card_c, border_c);
          apply_theme(id(nina3_cell_sat_px), card_c, border_c);
          apply_theme(id(nina3_cell_filter), card_c, border_c);
          apply_theme(id(nina3_cell_cam_temp), card_c, border_c);
          apply_theme(id(nina3_cell_stars), card_c, border_c);
          apply_theme(id(nina3_cell_cloud_detector), card_c, border_c);

          // Plants page cards
          apply_theme(id(card_plant_aglaonema), card_c, border_c);
          apply_theme(id(card_plant_begonia), card_c, border_c);
          apply_theme(id(card_plant_croton), card_c, border_c);
          apply_theme(id(card_plant_elephant_ears), card_c, border_c);
          apply_theme(id(card_plant_jade_plant), card_c, border_c);
          apply_theme(id(card_plant_monstera), card_c, border_c);
          apply_theme(id(card_plant_nerve_plant), card_c, border_c);
          apply_theme(id(card_plant_pothos), card_c, border_c);
          apply_theme(id(card_plant_spider_plant), card_c, border_c);

  - platform: template
    name: "Page Selection"
    id: page_selector
    optimistic: true
    initial_option: "Main Dashboard"
    icon: "mdi:layers-search"
    options:
      - "Main Dashboard"
      - "Combined NINA"
      - "NINA Instance 2"
      - "NINA Instance 3"
      - "Plant Monitor"
    set_action:
      - lambda: |-
          if (x == "Main Dashboard") {
             id(g_current_page) = 0;
             lv_scr_load_anim(id(main_page)->obj, LV_SCR_LOAD_ANIM_MOVE_LEFT, 300, 0, false);
             id(refresh_main_page).execute();
          } else if (x == "Combined NINA") {
             id(g_current_page) = 1;
             lv_scr_load_anim(id(combined_nina_page)->obj, LV_SCR_LOAD_ANIM_MOVE_LEFT, 300, 0, false);
          } else if (x == "NINA Instance 2") {
             id(g_current_page) = 2;
             lv_scr_load_anim(id(nina2_page)->obj, LV_SCR_LOAD_ANIM_MOVE_LEFT, 300, 0, false);
             id(refresh_nina2_page).execute();
          } else if (x == "NINA Instance 3") {
             id(g_current_page) = 3;
             lv_scr_load_anim(id(nina3_page)->obj, LV_SCR_LOAD_ANIM_MOVE_LEFT, 300, 0, false);
             id(refresh_nina3_page).execute();
          } else if (x == "Plant Monitor") {
             if (id(g_plants_enabled)) {
               id(g_current_page) = 4;
               lv_scr_load_anim(id(plants_page)->obj, LV_SCR_LOAD_ANIM_MOVE_LEFT, 300, 0, false);
               id(refresh_plants_page).execute();
             }
          }

light:
  - platform: monochromatic
    name: "backlight"
    output: backlight_
    id: backlight_light
    restore_mode: ALWAYS_ON
    default_transition_length: 0s
    gamma_correct: 1.0
    on_turn_on:
      - light.control:
          id: backlight_light
          brightness: 76.9%  # 196/255

  - name: "CPU Start Color"
    platform: rgb
    id: cpu_start_color
    internal: true
    red: cpu_start_red
    green: cpu_start_green
    blue: cpu_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: cpu_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "CPU End Color"
    platform: rgb
    id: cpu_end_color
    internal: true
    red: cpu_end_red
    green: cpu_end_green
    blue: cpu_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: cpu_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "Fan Start Color"
    platform: rgb
    id: fan_start_color
    internal: true
    red: fan_start_red
    green: fan_start_green
    blue: fan_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: fan_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "Fan End Color"
    platform: rgb
    id: fan_end_color
    internal: true
    red: fan_end_red
    green: fan_end_green
    blue: fan_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: fan_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "Env Start Color"
    platform: rgb
    id: env_start_color
    internal: true
    red: env_start_red
    green: env_start_green
    blue: env_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: env_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "Env End Color"
    platform: rgb
    id: env_end_color
    internal: true
    red: env_end_red
    green: env_end_green
    blue: env_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: env_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "Power Start Color"
    platform: rgb
    id: pwr_start_color
    internal: true
    red: pwr_start_red
    green: pwr_start_green
    blue: pwr_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: pwr_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "Power End Color"
    platform: rgb
    id: pwr_end_color
    internal: true
    red: pwr_end_red
    green: pwr_end_green
    blue: pwr_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: pwr_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "SQM Start Color"
    platform: rgb
    id: sqm_start_color
    internal: true
    red: sqm_start_red
    green: sqm_start_green
    blue: sqm_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: sqm_start_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "SQM End Color"
    platform: rgb
    id: sqm_end_color
    internal: true
    red: sqm_end_red
    green: sqm_end_green
    blue: sqm_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: sqm_end_color
          red: 18.0%   # 46/255
          green: 2.0%  # 5/255
          blue: 100%   # 255/255

  - name: "Cloud Status Light"
    platform: rgb
    id: cloud_status_light
    red: cloud_status_red
    green: cloud_status_green
    blue: cloud_status_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: cloud_status_light
          red: 100%    # 255/255
          green: 100%  # 255/255
          blue: 100%   # 255/255

  # NINA2 Color Lights
  - name: "NINA2 RMS Start Color"
    platform: rgb
    id: nina2_rms_start_color
    internal: true
    red: nina2_rms_start_red
    green: nina2_rms_start_green
    blue: nina2_rms_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_rms_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 RMS End Color"
    platform: rgb
    id: nina2_rms_end_color
    internal: true
    red: nina2_rms_end_red
    green: nina2_rms_end_green
    blue: nina2_rms_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_rms_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA2 HFR Start Color"
    platform: rgb
    id: nina2_hfr_start_color
    internal: true
    red: nina2_hfr_start_red
    green: nina2_hfr_start_green
    blue: nina2_hfr_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_hfr_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 HFR End Color"
    platform: rgb
    id: nina2_hfr_end_color
    internal: true
    red: nina2_hfr_end_red
    green: nina2_hfr_end_green
    blue: nina2_hfr_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_hfr_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA2 EXP NUM Start Color"
    platform: rgb
    id: nina2_exp_num_start_color
    internal: true
    red: nina2_exp_num_start_red
    green: nina2_exp_num_start_green
    blue: nina2_exp_num_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_exp_num_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 EXP NUM End Color"
    platform: rgb
    id: nina2_exp_num_end_color
    internal: true
    red: nina2_exp_num_end_red
    green: nina2_exp_num_end_green
    blue: nina2_exp_num_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_exp_num_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA2 EXP TIME Start Color"
    platform: rgb
    id: nina2_exp_time_start_color
    internal: true
    red: nina2_exp_time_start_red
    green: nina2_exp_time_start_green
    blue: nina2_exp_time_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_exp_time_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 EXP TIME End Color"
    platform: rgb
    id: nina2_exp_time_end_color
    internal: true
    red: nina2_exp_time_end_red
    green: nina2_exp_time_end_green
    blue: nina2_exp_time_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_exp_time_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA2 CAM TEMP Start Color"
    platform: rgb
    id: nina2_cam_temp_start_color
    internal: true
    red: nina2_cam_temp_start_red
    green: nina2_cam_temp_start_green
    blue: nina2_cam_temp_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_cam_temp_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 CAM TEMP End Color"
    platform: rgb
    id: nina2_cam_temp_end_color
    internal: true
    red: nina2_cam_temp_end_red
    green: nina2_cam_temp_end_green
    blue: nina2_cam_temp_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_cam_temp_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA2 STARS Start Color"
    platform: rgb
    id: nina2_stars_start_color
    internal: true
    red: nina2_stars_start_red
    green: nina2_stars_start_green
    blue: nina2_stars_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_stars_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 STARS End Color"
    platform: rgb
    id: nina2_stars_end_color
    internal: true
    red: nina2_stars_end_red
    green: nina2_stars_end_green
    blue: nina2_stars_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_stars_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA2 SAT PX Start Color"
    platform: rgb
    id: nina2_sat_px_start_color
    internal: true
    red: nina2_sat_px_start_red
    green: nina2_sat_px_start_green
    blue: nina2_sat_px_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_sat_px_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA2 SAT PX End Color"
    platform: rgb
    id: nina2_sat_px_end_color
    internal: true
    red: nina2_sat_px_end_red
    green: nina2_sat_px_end_green
    blue: nina2_sat_px_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina2_sat_px_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  # NINA3 Color Lights
  - name: "NINA3 RMS Start Color"
    platform: rgb
    id: nina3_rms_start_color
    internal: true
    red: nina3_rms_start_red
    green: nina3_rms_start_green
    blue: nina3_rms_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_rms_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 RMS End Color"
    platform: rgb
    id: nina3_rms_end_color
    internal: true
    red: nina3_rms_end_red
    green: nina3_rms_end_green
    blue: nina3_rms_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_rms_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA3 HFR Start Color"
    platform: rgb
    id: nina3_hfr_start_color
    internal: true
    red: nina3_hfr_start_red
    green: nina3_hfr_start_green
    blue: nina3_hfr_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_hfr_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 HFR End Color"
    platform: rgb
    id: nina3_hfr_end_color
    internal: true
    red: nina3_hfr_end_red
    green: nina3_hfr_end_green
    blue: nina3_hfr_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_hfr_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA3 EXP NUM Start Color"
    platform: rgb
    id: nina3_exp_num_start_color
    internal: true
    red: nina3_exp_num_start_red
    green: nina3_exp_num_start_green
    blue: nina3_exp_num_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_exp_num_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 EXP NUM End Color"
    platform: rgb
    id: nina3_exp_num_end_color
    internal: true
    red: nina3_exp_num_end_red
    green: nina3_exp_num_end_green
    blue: nina3_exp_num_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_exp_num_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA3 EXP TIME Start Color"
    platform: rgb
    id: nina3_exp_time_start_color
    internal: true
    red: nina3_exp_time_start_red
    green: nina3_exp_time_start_green
    blue: nina3_exp_time_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_exp_time_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 EXP TIME End Color"
    platform: rgb
    id: nina3_exp_time_end_color
    internal: true
    red: nina3_exp_time_end_red
    green: nina3_exp_time_end_green
    blue: nina3_exp_time_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_exp_time_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA3 CAM TEMP Start Color"
    platform: rgb
    id: nina3_cam_temp_start_color
    internal: true
    red: nina3_cam_temp_start_red
    green: nina3_cam_temp_start_green
    blue: nina3_cam_temp_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_cam_temp_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 CAM TEMP End Color"
    platform: rgb
    id: nina3_cam_temp_end_color
    internal: true
    red: nina3_cam_temp_end_red
    green: nina3_cam_temp_end_green
    blue: nina3_cam_temp_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_cam_temp_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA3 STARS Start Color"
    platform: rgb
    id: nina3_stars_start_color
    internal: true
    red: nina3_stars_start_red
    green: nina3_stars_start_green
    blue: nina3_stars_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_stars_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 STARS End Color"
    platform: rgb
    id: nina3_stars_end_color
    internal: true
    red: nina3_stars_end_red
    green: nina3_stars_end_green
    blue: nina3_stars_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_stars_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

  - name: "NINA3 SAT PX Start Color"
    platform: rgb
    id: nina3_sat_px_start_color
    internal: true
    red: nina3_sat_px_start_red
    green: nina3_sat_px_start_green
    blue: nina3_sat_px_start_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_sat_px_start_color
          red: 49.8%    # 127/255
          green: 67.5%  # 172/255
          blue: 100%    # 255/255

  - name: "NINA3 SAT PX End Color"
    platform: rgb
    id: nina3_sat_px_end_color
    internal: true
    red: nina3_sat_px_end_red
    green: nina3_sat_px_end_green
    blue: nina3_sat_px_end_blue
    restore_mode: RESTORE_DEFAULT_ON
    default_transition_length: 0s
    on_turn_on:
      - light.control:
          id: nina3_sat_px_end_color
          red: 100%    # 255/255
          green: 53.7% # 137/255
          blue: 5.5%   # 14/255

output:
  - platform: template
    type: float
    id: cpu_start_red
    write_action:
      - lambda: |-
          id(g_cpu_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: cpu_start_green
    write_action:
      - lambda: |-
          id(g_cpu_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: cpu_start_blue
    write_action:
      - lambda: |-
          id(g_cpu_c1_b) = state * 255.0;

  - platform: template
    type: float
    id: cpu_end_red
    write_action:
      - lambda: |-
          id(g_cpu_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: cpu_end_green
    write_action:
      - lambda: |-
          id(g_cpu_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: cpu_end_blue
    write_action:
      - lambda: |-
          id(g_cpu_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: fan_start_red
    write_action:
      - lambda: |-
          id(g_fan_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: fan_start_green
    write_action:
      - lambda: |-
          id(g_fan_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: fan_start_blue
    write_action:
      - lambda: |-
          id(g_fan_c1_b) = state * 255.0;

  - platform: template
    type: float
    id: fan_end_red
    write_action:
      - lambda: |-
          id(g_fan_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: fan_end_green
    write_action:
      - lambda: |-
          id(g_fan_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: fan_end_blue
    write_action:
      - lambda: |-
          id(g_fan_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: env_start_red
    write_action:
      - lambda: |-
          id(g_env_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: env_start_green
    write_action:
      - lambda: |-
          id(g_env_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: env_start_blue
    write_action:
      - lambda: |-
          id(g_env_c1_b) = state * 255.0;

  - platform: template
    type: float
    id: env_end_red
    write_action:
      - lambda: |-
          id(g_env_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: env_end_green
    write_action:
      - lambda: |-
          id(g_env_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: env_end_blue
    write_action:
      - lambda: |-
          id(g_env_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: pwr_start_red
    write_action:
      - lambda: |-
          id(g_pwr_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: pwr_start_green
    write_action:
      - lambda: |-
          id(g_pwr_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: pwr_start_blue
    write_action:
      - lambda: |-
          id(g_pwr_c1_b) = state * 255.0;

  - platform: template
    type: float
    id: pwr_end_red
    write_action:
      - lambda: |-
          id(g_pwr_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: pwr_end_green
    write_action:
      - lambda: |-
          id(g_pwr_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: pwr_end_blue
    write_action:
      - lambda: |-
          id(g_pwr_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: sqm_start_red
    write_action:
      - lambda: |-
          id(g_sqm_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: sqm_start_green
    write_action:
      - lambda: |-
          id(g_sqm_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: sqm_start_blue
    write_action:
      - lambda: |-
          id(g_sqm_c1_b) = state * 255.0;

  - platform: template
    type: float
    id: sqm_end_red
    write_action:
      - lambda: |-
          id(g_sqm_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: sqm_end_green
    write_action:
      - lambda: |-
          id(g_sqm_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: sqm_end_blue
    write_action:
      - lambda: |-
          id(g_sqm_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: cloud_status_red
    write_action:
      - lambda: |-
          id(g_cloud_r) = state * 255.0;
          lv_obj_set_style_text_color(id(lbl_cloud_status), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
  - platform: template
    type: float
    id: cloud_status_green
    write_action:
      - lambda: |-
          id(g_cloud_g) = state * 255.0;
          lv_obj_set_style_text_color(id(lbl_cloud_status), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
  - platform: template
    type: float
    id: cloud_status_blue
    write_action:
      - lambda: |-
          id(g_cloud_b) = state * 255.0;
          lv_obj_set_style_text_color(id(lbl_cloud_status), lv_color_hex(0xFFFFFF), LV_PART_MAIN);
  # NINA2 Color Outputs
  - platform: template
    type: float
    id: nina2_rms_start_red
    write_action:
      - lambda: id(g_nina2_rms_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_rms_start_green
    write_action:
      - lambda: id(g_nina2_rms_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_rms_start_blue
    write_action:
      - lambda: id(g_nina2_rms_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_rms_end_red
    write_action:
      - lambda: id(g_nina2_rms_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_rms_end_green
    write_action:
      - lambda: id(g_nina2_rms_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_rms_end_blue
    write_action:
      - lambda: id(g_nina2_rms_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina2_hfr_start_red
    write_action:
      - lambda: id(g_nina2_hfr_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_hfr_start_green
    write_action:
      - lambda: id(g_nina2_hfr_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_hfr_start_blue
    write_action:
      - lambda: id(g_nina2_hfr_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_hfr_end_red
    write_action:
      - lambda: id(g_nina2_hfr_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_hfr_end_green
    write_action:
      - lambda: id(g_nina2_hfr_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_hfr_end_blue
    write_action:
      - lambda: id(g_nina2_hfr_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina2_exp_num_start_red
    write_action:
      - lambda: id(g_nina2_exp_num_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_num_start_green
    write_action:
      - lambda: id(g_nina2_exp_num_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_num_start_blue
    write_action:
      - lambda: id(g_nina2_exp_num_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_num_end_red
    write_action:
      - lambda: id(g_nina2_exp_num_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_num_end_green
    write_action:
      - lambda: id(g_nina2_exp_num_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_num_end_blue
    write_action:
      - lambda: id(g_nina2_exp_num_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina2_exp_time_start_red
    write_action:
      - lambda: id(g_nina2_exp_time_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_time_start_green
    write_action:
      - lambda: id(g_nina2_exp_time_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_time_start_blue
    write_action:
      - lambda: id(g_nina2_exp_time_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_time_end_red
    write_action:
      - lambda: id(g_nina2_exp_time_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_time_end_green
    write_action:
      - lambda: id(g_nina2_exp_time_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_exp_time_end_blue
    write_action:
      - lambda: id(g_nina2_exp_time_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina2_cam_temp_start_red
    write_action:
      - lambda: id(g_nina2_cam_temp_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_cam_temp_start_green
    write_action:
      - lambda: id(g_nina2_cam_temp_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_cam_temp_start_blue
    write_action:
      - lambda: id(g_nina2_cam_temp_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_cam_temp_end_red
    write_action:
      - lambda: id(g_nina2_cam_temp_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_cam_temp_end_green
    write_action:
      - lambda: id(g_nina2_cam_temp_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_cam_temp_end_blue
    write_action:
      - lambda: id(g_nina2_cam_temp_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina2_stars_start_red
    write_action:
      - lambda: id(g_nina2_stars_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_stars_start_green
    write_action:
      - lambda: id(g_nina2_stars_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_stars_start_blue
    write_action:
      - lambda: id(g_nina2_stars_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_stars_end_red
    write_action:
      - lambda: id(g_nina2_stars_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_stars_end_green
    write_action:
      - lambda: id(g_nina2_stars_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_stars_end_blue
    write_action:
      - lambda: id(g_nina2_stars_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina2_sat_px_start_red
    write_action:
      - lambda: id(g_nina2_sat_px_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_sat_px_start_green
    write_action:
      - lambda: id(g_nina2_sat_px_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_sat_px_start_blue
    write_action:
      - lambda: id(g_nina2_sat_px_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina2_sat_px_end_red
    write_action:
      - lambda: id(g_nina2_sat_px_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina2_sat_px_end_green
    write_action:
      - lambda: id(g_nina2_sat_px_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina2_sat_px_end_blue
    write_action:
      - lambda: id(g_nina2_sat_px_c2_b) = state * 255.0;

  # NINA3 Color Outputs
  - platform: template
    type: float
    id: nina3_rms_start_red
    write_action:
      - lambda: id(g_nina3_rms_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_rms_start_green
    write_action:
      - lambda: id(g_nina3_rms_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_rms_start_blue
    write_action:
      - lambda: id(g_nina3_rms_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_rms_end_red
    write_action:
      - lambda: id(g_nina3_rms_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_rms_end_green
    write_action:
      - lambda: id(g_nina3_rms_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_rms_end_blue
    write_action:
      - lambda: id(g_nina3_rms_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina3_hfr_start_red
    write_action:
      - lambda: id(g_nina3_hfr_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_hfr_start_green
    write_action:
      - lambda: id(g_nina3_hfr_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_hfr_start_blue
    write_action:
      - lambda: id(g_nina3_hfr_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_hfr_end_red
    write_action:
      - lambda: id(g_nina3_hfr_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_hfr_end_green
    write_action:
      - lambda: id(g_nina3_hfr_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_hfr_end_blue
    write_action:
      - lambda: id(g_nina3_hfr_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina3_exp_num_start_red
    write_action:
      - lambda: id(g_nina3_exp_num_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_num_start_green
    write_action:
      - lambda: id(g_nina3_exp_num_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_num_start_blue
    write_action:
      - lambda: id(g_nina3_exp_num_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_num_end_red
    write_action:
      - lambda: id(g_nina3_exp_num_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_num_end_green
    write_action:
      - lambda: id(g_nina3_exp_num_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_num_end_blue
    write_action:
      - lambda: id(g_nina3_exp_num_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina3_exp_time_start_red
    write_action:
      - lambda: id(g_nina3_exp_time_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_time_start_green
    write_action:
      - lambda: id(g_nina3_exp_time_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_time_start_blue
    write_action:
      - lambda: id(g_nina3_exp_time_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_time_end_red
    write_action:
      - lambda: id(g_nina3_exp_time_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_time_end_green
    write_action:
      - lambda: id(g_nina3_exp_time_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_exp_time_end_blue
    write_action:
      - lambda: id(g_nina3_exp_time_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina3_cam_temp_start_red
    write_action:
      - lambda: id(g_nina3_cam_temp_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_cam_temp_start_green
    write_action:
      - lambda: id(g_nina3_cam_temp_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_cam_temp_start_blue
    write_action:
      - lambda: id(g_nina3_cam_temp_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_cam_temp_end_red
    write_action:
      - lambda: id(g_nina3_cam_temp_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_cam_temp_end_green
    write_action:
      - lambda: id(g_nina3_cam_temp_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_cam_temp_end_blue
    write_action:
      - lambda: id(g_nina3_cam_temp_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina3_stars_start_red
    write_action:
      - lambda: id(g_nina3_stars_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_stars_start_green
    write_action:
      - lambda: id(g_nina3_stars_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_stars_start_blue
    write_action:
      - lambda: id(g_nina3_stars_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_stars_end_red
    write_action:
      - lambda: id(g_nina3_stars_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_stars_end_green
    write_action:
      - lambda: id(g_nina3_stars_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_stars_end_blue
    write_action:
      - lambda: id(g_nina3_stars_c2_b) = state * 255.0;

  - platform: template
    type: float
    id: nina3_sat_px_start_red
    write_action:
      - lambda: id(g_nina3_sat_px_c1_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_sat_px_start_green
    write_action:
      - lambda: id(g_nina3_sat_px_c1_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_sat_px_start_blue
    write_action:
      - lambda: id(g_nina3_sat_px_c1_b) = state * 255.0;
  - platform: template
    type: float
    id: nina3_sat_px_end_red
    write_action:
      - lambda: id(g_nina3_sat_px_c2_r) = state * 255.0;
  - platform: template
    type: float
    id: nina3_sat_px_end_green
    write_action:
      - lambda: id(g_nina3_sat_px_c2_g) = state * 255.0;
  - platform: template
    type: float
    id: nina3_sat_px_end_blue
    write_action:
      - lambda: id(g_nina3_sat_px_c2_b) = state * 255.0;